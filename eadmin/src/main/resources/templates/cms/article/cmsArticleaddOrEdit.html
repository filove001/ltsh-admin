<html>
<head>
<meta charset="utf-8">
<title>${title}</title>
	<link rel="stylesheet" href="${ctx}/ztree/css/zTreeStyle/zTreeStyle.css">
	<link rel="stylesheet" href="${ui}/css/layui.css">
	<link rel="stylesheet" href="${ctx}/css/addOrEdit.css">
</head>
<body>
<section class="dx-info-default">
  <div class="dx-info-box type-add">
    <form class="layui-form" action="">
		<div class="layui-form-item" <%if(has(idDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">id</label>
	        <div class="layui-input-block dx-input-required">                <input <%if(has(idDisabled)){%>disabled<%}%> type="text" value="${obj.id!}" name="id"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(categoryIdDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">目录id</label>
	        <div class="layui-input-block">
				<input   onclick="showMenu();" <%if(has(categoryIdDisabled)){%>disabled<%}%> type="text" value="${obj.categoryId!}" id="categoryId" name="categoryId"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(titleDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">文章名称</label>
	        <div class="layui-input-block">                <input <%if(has(titleDisabled)){%>disabled<%}%> type="text" value="${obj.title!}" name="title"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>

		<div class="layui-form-item" <%if(has(statusDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">状态//radio/-1隐藏,1,显示</label>
	        <div class="layui-input-block">                <input <%if(has(statusDisabled)){%>disabled<%}%> type="text" value="${obj.status!}" name="status"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(isCommentDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">是否评论</label>
	        <div class="layui-input-block">                <input <%if(has(isCommentDisabled)){%>disabled<%}%> type="text" value="${obj.isComment!}" name="isComment"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(isRecommendDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">是否推荐</label>
	        <div class="layui-input-block">                <input <%if(has(isRecommendDisabled)){%>disabled<%}%> type="text" value="${obj.isRecommend!}" name="isRecommend"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(sortDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">排序</label>
	        <div class="layui-input-block">                <input <%if(has(sortDisabled)){%>disabled<%}%> type="number" value="${obj.sort!}" name="sort"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(hrefDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">跳转地址</label>
	        <div class="layui-input-block">                <input <%if(has(hrefDisabled)){%>disabled<%}%> type="text" value="${obj.href!}" name="href"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(imageUrlDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">图片路径</label>

	        <div class="layui-input-block">
				<img id="upload-img" src="${obj.imageUrl!}" style="width:105px;height:80px;">
				<input style="display:none" type="text" value="${obj.imageUrl!}" name="imageUrl" id="imageUrl" class="layui-input layui-form-danger">
				<input <%if(has(imageUrlDisabled)){%>disabled<%}%> type="file"  name="file"  class="layui-upload-file">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(approveStatusDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">审核状态</label>
	        <div class="layui-input-block">                <input <%if(has(approveStatusDisabled)){%>disabled<%}%> type="text" value="${obj.approveStatus!}" name="approveStatus"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(remarksDisplayNone)){%> style="display:none"<%}%>>
	        <label class="layui-form-label">备注信息</label>
	        <div class="layui-input-block">                <input <%if(has(remarksDisabled)){%>disabled<%}%> type="text" value="${obj.remarks!}" name="remarks"  autocomplete="off" placeholder="" class="layui-input layui-form-danger">
	        </div>
      	</div>
		<div class="layui-form-item" <%if(has(contentDisplayNone)){%> style="display:none"<%}%>>
		<label class="layui-form-label">内容</label>
		<div class="layui-input-block">
			<textarea class="layui-textarea" id="content" name="content" style="display: none">
				${obj.content!}
			</textarea>
		</div>
		</div>
      <br>

      <div class="layui-form-item form-btn-box">
        <div class="layui-input-block">
          <button type="button" class="layui-btn layui-btn-primary btn-simple-blue add-hide" onclick="window.history.go(-1);">取消</button>
          <button type="reset" class="layui-btn layui-btn-primary btn-simple-blue update-hide">重置</button>
          <button class="layui-btn" lay-submit="" lay-filter="info">提交</button>
        </div>
      </div>
    </form>
  </div>
</section>


<div id="menuContent" class="menuContent" style="display:none; position: absolute;background-color: #e2e2e2">
	<ul id="treeDemo" class="ztree" style="margin-top:0; width:180px; height: 300px;"></ul>
</div>

<div id="LAY_democodejs">
	<script src="${ctx}/js/jquery.min.js" charset="utf-8"></script>
	<script src="${ui}/lay/dest/layui.all.js" charset="utf-8"></script>
	<script src="${ctx}/js/common.js" charset="utf-8"></script>
	<script src="${ctx}/js/addOrEdit.js" charset="utf-8"></script>
	<script src="${ctx}/ztree/js/jquery.ztree.all.min.js"></script>
<script>
var layeditIndex;
function addEditInit(){
    var layedit = layui.layedit;
    layui.upload({
		url: '/file/upload' //接口url
		,unwrap: false //其实就是不向你的input包裹upload组件的ui元素
		,success: function(res, input){
		    var src=res.data.src;
			$('#upload-img').attr('src',src);
//			input.value=res.data.src;
			$('#imageUrl').val(src);
		}
	});
    layedit.set({
        uploadImage: {
            url: '/file/upload' //接口url
        }
    });
    //注意：layedit.set 一定要放在 build 前面，否则配置全局接口将无效。
    //构建一个默认的编辑器
    layeditIndex = layedit.build('content',{
        width:1111,
        height: 500 //设置编辑器高度
	});
    $('.layui-layedit').width($('.layui-form').width()-192);//编辑框大小
    $.fn.zTree.init($("#treeDemo"), setting, zNodes);
}
function beforeSubmit(data){
    layui.layedit.sync(layeditIndex);
    data.content=layui.layedit.getContent(layeditIndex);
}



var setting = {
    view: {
        dblClickExpand: false
    },
    data: {
        simpleData: {
            enable: true
        }
    },
    callback: {
        beforeClick: beforeClick,
        onClick: onClick
    }
};
//树
var zNodes =${ztree};

function beforeClick(treeId, treeNode) {
    var check = (treeNode && !treeNode.isParent);
    if (!check) alert("只能选择...");
    return check;
}

function onClick(e, treeId, treeNode) {
    var zTree = $.fn.zTree.getZTreeObj("treeDemo"),
        nodes = zTree.getSelectedNodes(),
        v = "";
    nodes.sort(function compare(a,b){return a.id-b.id;});
    for (var i=0, l=nodes.length; i<l; i++) {
        v += nodes[i].name + ",";
    }
    if (v.length > 0 ) v = v.substring(0, v.length-1);
    var cityObj = $("#categoryId");
//    cityObj.attr("value", v);
    cityObj.attr("value",nodes[0].id);
    hideMenu();
}

function showMenu() {
    var cityObj = $("#categoryId");
    var cityOffset = $("#categoryId").offset();
    $("#menuContent").css({left:cityOffset.left + "px", top:cityOffset.top + cityObj.outerHeight() + "px"}).slideDown("fast");
    $("body").bind("mousedown", onBodyDown);
}
function hideMenu() {
    $("#menuContent").fadeOut("fast");
    $("body").unbind("mousedown", onBodyDown);
}
function onBodyDown(event) {
    if (!(event.target.id == "menuBtn" || event.target.id == "menuContent" || $(event.target).parents("#menuContent").length>0)) {
        hideMenu();
    }
}

</script>
</div>
</body>
</html>